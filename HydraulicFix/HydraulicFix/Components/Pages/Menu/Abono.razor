@page "/abono"
@page "/abono/{VentaId:int}"
@inject ApplicationDbContext _contexto
@inject NavigationManager NavigationManager
@inject AbonosService abonosService

<div class="container">
    <div class="card shadow">
        <div class="card-header">
            <h3 class="text-center">Abonar Venta</h3>
        </div>
        <div class="card-body">
            @if (venta != null)
            {
                <div class="card shadow">
                    <div class="card-body">
                        <h4 class="card-title">Detalle de Venta</h4>
                        <p class="card-text">Venta ID: @venta.VentaId</p>
                        <p class="card-text">Monto Total: @venta.Total</p>
                    </div>
                </div>

                <hr />

                <div class="card shadow">
                    <div class="card-body">
                        <h4 class="card-title">Realizar Abono</h4>

                        <EditForm Model="@abonoDetalle" >
                            <DataAnnotationsValidator />

                            <div class="form-group">
                                <label for="FechaAbono">Fecha de Abono:</label>
                                <InputDate @bind-Value="@abonoDetalle.Fecha" class="form-control" id="FechaAbono" />
                                <ValidationMessage For="@(() => abonoDetalle.Fecha)" />
                            </div>

                            <div class="form-group">
                                <label for="MetodoPagoId">Método de Pago:</label>
                                <select @bind="@abonoDetalle.MetodoPagoId" class="form-control" id="MetodoPagoId">
                                    <option value="">Seleccionar método de pago</option>
                                    @foreach (var metodoPago in listaMetodoPago)
                                    {
                                        <option value="@metodoPago.MetodoPagoId">@metodoPago.Nombre</option>
                                    }
                                </select>
                                <ValidationMessage For="@(() => abonoDetalle.MetodoPagoId)" />
                            </div>

                            <div class="form-group">
                                <label for="MontoAbono">Monto a Abonar:</label>
                                <InputNumber @bind-Value="@abonoDetalle.Monto" class="form-control" id="MontoAbono" step="0.01" />
                                <ValidationMessage For="@(() => abonoDetalle.Monto)" />
                            </div>
                            <button type="submit" class="btn btn-primary">Realizar Abono</button>
                        </EditForm>
                    </div>
                </div>
            }
            else
            {
                <p class="text-center mt-3">Cargando información de la venta...</p>
            }
        </div>
    </div>
</div>

@code {
    [Parameter]
    public int VentaId { get; set; }

    private Ventas venta = new Ventas();
    private AbonosDetalle abonoDetalle = new AbonosDetalle();

    public List<MetodoPagos> listaMetodoPago = new List<MetodoPagos>();
    public List<Condiciones> condiciones { get; set; } = new List<Condiciones>();

 

}
